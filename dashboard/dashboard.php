<div class="container-xxl flex-grow-1 container-p-y">
    <div class="row">
        <!-- <div class="col-md-12 col-lg-12 order-1 mb-4">
            <div class="card h-100">
                <div class="card-header d-flex align-items-center justify-content-between">
                    <div class="card-title mb-0">
                        <h5 class="m-0 me-2">Budget</h5>
                        <small class="text-muted">February, 2023</small>
                    </div>
                    <div class="dropdown">
                        <button class="btn p-0" type="button" id="transactionID" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="bx bx-dots-vertical-rounded"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="transactionID">
                            <a class="dropdown-item" href="javascript:void(0);">Add budget</a>
                            <a class="dropdown-item" href="javascript:void(0);">Edit Budget</a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <ul class="p-0 m-0">
                        <li class="d-flex mb-4 pb-1">
                            <div class="avatar flex-shrink-0 me-3">
                                <img src="../assets/img/icons/unicons/paypal.png" alt="User" class="rounded" />
                            </div>
                            <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                <div class="me-2">
                                    <small class="text-muted d-block mb-1">Food&Beverage</small>
                                    <h6 class="mb-0">Rp 3.000.000</h6>
                                </div>
                                <div class="user-progress d-flex align-items-center gap-1">
                                    <h6 class="mb-0">+2.700.000</h6>
                                    <span class="text-muted">IDR</span>
                                </div>
                            </div>
                        </li>
                        <li class="d-flex mb-4 pb-1">
                            <div class="avatar flex-shrink-0 me-3">
                                <img src="../assets/img/icons/unicons/wallet.png" alt="User" class="rounded" />
                            </div>
                            <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                <div class="me-2">
                                    <small class="text-muted d-block mb-1">Grocery</small>
                                    <h6 class="mb-0">Rp 500.000</h6>
                                </div>
                                <div class="user-progress d-flex align-items-center gap-1">
                                    <h6 class="mb-0">+500.000</h6>
                                    <span class="text-muted">IDR</span>
                                </div>
                            </div>
                        </li>
                        <li class="d-flex mb-4 pb-1">
                            <div class="avatar flex-shrink-0 me-3">
                                <img src="../assets/img/icons/unicons/chart.png" alt="User" class="rounded" />
                            </div>
                            <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                <div class="me-2">
                                    <small class="text-muted d-block mb-1">Kost</small>
                                    <h6 class="mb-0">Rp 1.500.000</h6>
                                </div>
                                <div class="user-progress d-flex align-items-center gap-1">
                                    <h6 class="mb-0">+0</h6>
                                    <span class="text-muted">IDR</span>
                                </div>
                            </div>
                        </li>
                        <li class="d-flex mb-4 pb-1">
                            <div class="avatar flex-shrink-0 me-3">
                                <img src="../assets/img/icons/unicons/cc-success.png" alt="User" class="rounded" />
                            </div>
                            <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                <div class="me-2">
                                    <small class="text-muted d-block mb-1">Gasoline</small>
                                    <h6 class="mb-0">Rp 100.000</h6>
                                </div>
                                <div class="user-progress d-flex align-items-center gap-1">
                                    <h6 class="mb-0">-30.000</h6>
                                    <span class="text-muted">IDR</span>
                                </div>
                            </div>
                        </li>
                        <li class="d-flex mb-4 pb-1">
                            <div class="avatar flex-shrink-0 me-3">
                                <img src="../assets/img/icons/unicons/wallet.png" alt="User" class="rounded" />
                            </div>
                            <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                <div class="me-2">
                                    <small class="text-muted d-block mb-1">Skincare</small>
                                    <h6 class="mb-0">Rp 250.000</h6>
                                </div>
                                <div class="user-progress d-flex align-items-center gap-1">
                                    <h6 class="mb-0">+100.000</h6>
                                    <span class="text-muted">IDR</span>
                                </div>
                            </div>
                        </li>
                        <li class="d-flex">
                            <div class="avatar flex-shrink-0 me-3">
                                <img src="../assets/img/icons/unicons/cc-warning.png" alt="User" class="rounded" />
                            </div>
                            <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                <div class="me-2">
                                    <small class="text-muted d-block mb-1">Spoiled</small>
                                    <h6 class="mb-0">Rp 150.000</h6>
                                </div>
                                <div class="user-progress d-flex align-items-center gap-1">
                                    <h6 class="mb-0">-25.000</h6>
                                    <span class="text-muted">IDR</span>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div> -->
        <div class="col-lg-12 mb-4 order-2">
            <div class="card">
                <div class="card-body">
                    <!-- <div class="row">
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label for="defaultSelect" class="form-label">Payment</label>
                                <select id="defaultSelect" class="form-select">
                                    <option>Default select</option>
                                    <option value="mandiri">Mandiri</option>
                                    <option value="bca">BCA</option>
                                    <option value="cash">Cash</option>
                                    <option value="shopeepay">ShopeePay</option>
                                    <option value="gopay">Gopay</option>
                                    <option value="ovo">OVO</option>
                                    <option value="linkaja">LinkAja</option>
                                </select>
                            </div>
                        </div>
                    </div> -->
                    <div class="d-flex align-items-end row">

                        <div class="col-sm-6">
                            <div class="mb-3">
                                <div id="nomerror" class="col-12 mb-1" style="background-color:#F8D7DA; padding-left: 10px; display: none;">
                                    <label for="defaultSelect" class="form-label" style="color: #B02A37;">Masukkan nominal</label>
                                </div>
                                <div class="input-group input-group-merge">
                                    <span class="input-group-text">Rp</span>
                                    <input type="number" required name="nominal" id="nominal" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1').replace(/^0[^.]/, '0');" class="form-control" placeholder="0" aria-label="Amount (to the nearest dollar)" />
                                    <span class="input-group-text">.00</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="mb-3">
                                <div id="katerror" class="col-12 mb-1" style="background-color:#F8D7DA; padding-left: 10px; display: none;">
                                    <label for="defaultSelect" class="form-label" style="color: #B02A37;">Pilih category</label>
                                </div>
                                <select required id="kategori" name="kategori" class="form-select cari">
                                    <option value="" selected disabled>Select category</option>
                                    <?php
                                    $sql = mysqli_query($connect, "SELECT * FROM outcome_category_list ORDER BY c_name ASC");
                                    while ($data = mysqli_fetch_array($sql)) {
                                    ?>
                                        <option value="<?= $data['c_code'] ?>"><?= $data['c_name'] ?></option>
                                    <?php
                                    }
                                    ?>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="mb-3 row">
                                <div class="col-md-12">
                                    <div id="tangerror" class="col-12 mb-1" style="background-color:#F8D7DA; padding-left: 10px; display: none;">
                                        <label for="defaultSelect" class="form-label" style="color: #B02A37;">Masukkan tanggal dan waktu</label>
                                    </div>
                                    <div id="masadepanerror" class="col-12 mb-1" style="background-color:#F8D7DA; padding-left: 10px; display: none;">
                                        <label for="defaultSelect" class="form-label" style="color: #B02A37;">Tidak bisa memasukkan waktu masa depan</label>
                                    </div>
                                    <input required class="form-control" type="datetime-local" name="tanggal" id="tanggal" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div id="noterror" class="col-12 mb-1" style="background-color:#F8D7DA; padding-left: 10px; display: none;">
                                <label for="defaultSelect" class="form-label" style="color: #B02A37;">Masukkan note</label>
                            </div>
                            <div class="form-floating">
                                <input type="text" required name="note" class="form-control" id="note" placeholder="Mcd, Cola, etc" aria-describedby="floatingInputHelp" />
                                <label for="floatingInput">Note</label>
                                <!-- <div id="floatingInputHelp" class="form-text">We'll never share your details with anyone else.</div> -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 text-center mt-3">
                            <button style="width: 200px;" type="button" name="record" id="record" class="btn btn-primary">Record</button>
                            <!-- <button style="width: 200px;" class="btn btn-primary" type="button" disabled>
                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                Loading...
                            </button> -->
                        </div>
                    </div>
                    <script>
                        $(document).ready(function() {
                            $('#record').click(function() {
                                var nominal = $('#nominal').val();
                                var kategori = $('#kategori').val();
                                var tanggal = $('#tanggal').val();
                                var catatan = $('#note').val();

                                // memastikan tidak melakukan input waktu masa depan
                                var mydate = new Date();
                                var cek = new Date(tanggal);
                                if (mydate > cek) {
                                    var info = 'aman';
                                } else {
                                    var info = 'gaiso input pengeluaran masa depan cok';
                                }

                                if (nominal == '') {
                                    $('#nomerror').show();
                                    setTimeout(function() {
                                        $('#nomerror').hide()
                                    }, 3000);
                                }
                                if (kategori == null) {
                                    $('#katerror').show();
                                    setTimeout(function() {
                                        $('#katerror').hide()
                                    }, 3000);
                                }
                                if (tanggal == '') {
                                    $('#tangerror').show();
                                    setTimeout(function() {
                                        $('#tangerror').hide()
                                    }, 3000);
                                } else {
                                    if (info != 'aman') {
                                        $('#masadepanerror').show();
                                        setTimeout(function() {
                                            $('#masadepanerror').hide()
                                        }, 3000);
                                    }
                                }
                                if (catatan == '') {
                                    $('#noterror').show();
                                    setTimeout(function() {
                                        $('#noterror').hide()
                                    }, 3000);
                                }


                                // jika sudah isi semua
                                if (nominal != '' && kategori != null && tanggal != '' && catatan != '' && info == 'aman') {
                                    $.ajax({
                                        url: 'record.php',
                                        type: 'POST',
                                        data: {
                                            "nominal": nominal,
                                            "kategori": kategori,
                                            "tanggal": tanggal,
                                            "catatan": catatan
                                        },
                                        success: function(response) {
                                            if (response == 'success') {
                                                Swal.fire({
                                                    title: 'Succes!',
                                                    text: 'Data recorded!',
                                                    icon: 'success',
                                                    timer: 1500,
                                                    showCancelButton: false,
                                                    showConfirmButton: false
                                                });
                                                $('#nominal').val('');
                                                $('#kategori').val('').trigger('change');
                                                $('#tanggal').val('');
                                                $('#note').val('');
                                            } else {
                                                Swal.fire({
                                                    title: 'Error!',
                                                    text: 'Server busy!',
                                                    type: 'error',
                                                    confirmButtonText: 'OK'
                                                });
                                            }
                                        }
                                    });
                                }
                            });
                        });
                    </script>

                </div>
            </div>
        </div>

        <!-- Total Revenue -->
        <div class="col-12 col-lg-12 order-2 order-md-3 order-lg-3 mb-4">

            <div id="pagedatabulanan">
            </div>

            <script type="text/javascript">
                $(document).ready(function() {

                    $('#pagedatabulanan').load('rekapbulanan.php').fadeIn("slow");

                    var auto_refresh = setInterval(function() {
                        $('#pagedatabulanan').load('rekapbulanan.php').fadeIn("slow");
                    }, 1000);

                });
            </script>
        </div>
        <!--/ Total Revenue -->
    </div>
</div>